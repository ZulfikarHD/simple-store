import{d as E,E as S,c as _,g as $,w as k,G as A,C as L,m as T,T as b,N as M,o as W}from"./app-Bup2iCrW.js";import{f as z,g as B,h as D,m as p,r as h,i as j}from"./shopping-bag-Cyqv5MtD.js";function G(c){const t=new WeakMap,u=z();function d(o){if(c.mode!=="popLayout")return;const i=o.element,l=i.offsetParent,m=l instanceof HTMLElement&&l.offsetWidth||0,s={height:i.offsetHeight||0,width:i.offsetWidth||0,top:i.offsetTop,left:i.offsetLeft,right:0};s.right=m-s.width-s.left;const n=c.anchorX==="left"?`left: ${s.left}`:`right: ${s.right}`;o.element.dataset.motionPopId=o.id;const e=document.createElement("style");u.value.nonce&&(e.nonce=u.value.nonce),t.set(o,e),document.head.appendChild(e),e.sheet&&e.sheet.insertRule(`
    [data-motion-pop-id="${o.id}"] {
      position: absolute !important;
      width: ${s.width}px !important;
      height: ${s.height}px !important;
      top: ${s.top}px !important;
      ${n}px !important;
      }
      `)}function f(o){const i=t.get(o);i&&(t.delete(o),B.render(()=>{document.head.removeChild(i)}))}return{addPopStyle:d,removePopStyle:f,styles:t}}function P(c){return Promise.resolve().then(()=>{c()})}const U=E({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(c){const t=c;D(t);const{addPopStyle:u,removePopStyle:d,styles:f}=G(t);function o(n){let e=n;for(;e;){if(p.get(e))return e;e=e.firstElementChild}return null}function i(n){const e=p.get(n);e&&(d(e),e.isVShow=!0,h(n),P(()=>{e.setActive("exit",!1)}))}const l=new Map;S(()=>{l.clear()});function m(n,e){var v;const r=o(n),a=p.get(r);if(!r||!a){e(),l.size===0&&((v=t.onExitComplete)==null||v.call(t));return}l.set(r,!0),h(r),u(a);function g(w){var y,C;if((y=w?.detail)!=null&&y.isExit){const x=a.visualElement.projection;if(x?.animationProgress>0&&!a.isSafeToRemove&&!a.isVShow)return;h(r),l.delete(r),l.size===0&&((C=t.onExitComplete)==null||C.call(t)),f.has(a)?d(a):a.willUpdate("done"),e(),r.isConnected||a.unmount(!0)}}P(()=>{a.setActive("exit",!0),j.set(r,g),r.addEventListener("motioncomplete",g)})}const s=_(()=>t.mode!=="wait"?{tag:t.as}:{mode:t.mode==="wait"?"out-in":void 0});return(n,e)=>(W(),$(T(n.mode==="wait"?b:M),L({css:!1},s.value,{appear:"",onEnter:i,onLeave:m}),{default:k(()=>[A(n.$slots,"default")]),_:3},16))}});export{U as _};
