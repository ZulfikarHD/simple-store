import{r as re,s as ne,q as le,b as ie,c as ue,d as ce,S as de,_ as fe,f as pe,g as me}from"./Layout-CPmfG_UV.js";import{c as O,e as L,j as ve,M as T,s as E,a as J}from"./shopping-bag-CgJLrDmv.js";import{d as x,a as u,G as P,q as M,f as e,o as s,c as j,g as v,w as a,b as t,j as f,t as $,e as o,F as b,k as F,r as w,N as Z,y as ye,i as _e,m as he,D as z,C as K,L as ee,ap as be,aq as ge,z as ke,u as we,E as xe,h as Ce,J as $e,K as Se}from"./app-CZppbeYQ.js";import{C as Ae}from"./circle-alert-C70UCszn.js";import{_ as k}from"./index-Cc65Ncch.js";import{_ as Fe,a as Re}from"./CardContent.vue_vue_type_script_setup_true_lang-D9FgFAoY.js";import{a as Te,_ as Ee}from"./CardTitle.vue_vue_type_script_setup_true_lang-hL4MGq2q.js";import{s as qe,E as je,f as Me,b as Ve,c as De,d as ze,a as Le,_ as Pe}from"./AppLayout.vue_vue_type_script_setup_true_lang-CNgCg_lr.js";import{R as Be}from"./refresh-cw-DmBMclfO.js";import{_ as Ie}from"./InputError.vue_vue_type_script_setup_true_lang-SbAcGJYD.js";import{_ as X}from"./Spinner.vue_vue_type_script_setup_true_lang-DwadFHo_.js";import{_ as Ne,a as Oe,b as Ke}from"./PinInputSlot.vue_vue_type_script_setup_true_lang-Be0ohunr.js";import{f as He}from"./Input.vue_vue_type_script_setup_true_lang-D5qj-S-y.js";import{C as Qe}from"./check-KYstt4-N.js";import{C as Ue}from"./copy-CfMMjgAH.js";import{_ as W}from"./index-ChOoFR3L.js";import{S as Y}from"./shield-check-CFRMjlmf.js";import"./Separator.vue_vue_type_script_setup_true_lang-CBTlUHzw.js";import"./index-Dp0PW41R.js";import"./index-C6DL73fo.js";import"./user-BcBa71Ld.js";import"./lock-wwAmgkYU.js";import"./palette-DPQLYTye.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VisuallyHidden-dee-T_ua.js";import"./useForwardExpose-BON2X7ZT.js";import"./RovingFocusGroup-DlfWv2G2.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./package-D47XvBWL.js";import"./settings-DyBCjIIM.js";import"./log-out-Bbr3RYW6.js";import"./x-C5bMfCMh.js";import"./index-jc7A-Wt-.js";import"./chevron-right-BwmxWRAz.js";import"./PriceDisplay.vue_vue_type_script_setup_true_lang-s8qMSPGe.js";import"./Label.vue_vue_type_script_setup_true_lang-BiUR-eYh.js";import"./loader-circle-Dh4DslJv.js";import"./circle-check-Dq0cs3o_.js";import"./clock-DtWUUNZy.js";import"./phone-CutlmKqZ.js";import"./VisuallyHiddenInput-CmbrwRCq.js";const Ge=O("LockKeyholeIcon",[["circle",{cx:"12",cy:"16",r:"1",key:"1au0dj"}],["rect",{x:"3",y:"10",width:"18",height:"12",rx:"2",key:"6s8ecr"}],["path",{d:"M7 10V7a5 5 0 0 1 10 0v3",key:"1pqi11"}]]);const Je=O("ScanLineIcon",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);const Xe=O("ShieldBanIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m4.243 5.21 14.39 12.472",key:"1c9a7c"}]]),We=x({__name:"CardDescription",props:{class:{}},setup(l){const n=l;return(i,d)=>(s(),u("p",{"data-slot":"card-description",class:M(e(L)("text-muted-foreground text-sm",n.class))},[P(i.$slots,"default")],2))}}),Ye=x({__name:"Alert",props:{class:{},variant:{}},setup(l){const n=l;return(i,d)=>(s(),u("div",{"data-slot":"alert",class:M(e(L)(e(tt)({variant:l.variant}),n.class)),role:"alert"},[P(i.$slots,"default")],2))}}),Ze=x({__name:"AlertDescription",props:{class:{}},setup(l){const n=l;return(i,d)=>(s(),u("div",{"data-slot":"alert-description",class:M(e(L)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",n.class))},[P(i.$slots,"default")],2))}}),et=x({__name:"AlertTitle",props:{class:{}},setup(l){const n=l;return(i,d)=>(s(),u("div",{"data-slot":"alert-title",class:M(e(L)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",n.class))},[P(i.$slots,"default")],2))}}),tt=ve("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}}),at={class:"list-inside list-disc text-sm"},te=x({__name:"AlertError",props:{errors:{},title:{default:"Something went wrong."}},setup(l){const n=l,i=j(()=>Array.from(new Set(n.errors)));return(d,m)=>(s(),v(e(Ye),{variant:"destructive"},{default:a(()=>[t(e(Ae),{class:"size-4"}),t(e(et),null,{default:a(()=>[f($(l.title),1)]),_:1}),t(e(Ze),null,{default:a(()=>[o("ul",at,[(s(!0),u(b,null,F(i.value,(_,y)=>(s(),u("li",{key:y},$(_),1))),128))])]),_:1})]),_:1}))}}),N=async l=>{const n=await fetch(l,{method:"GET",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"},credentials:"same-origin"});if(n.status===401||n.status===419)throw new Error("Session expired. Please refresh the page.");if(!n.ok)throw new Error(`Failed to fetch: ${n.status}`);return n.json()},q=w([]),S=w(null),A=w(null),D=w([]),st=j(()=>A.value!==null&&S.value!==null),H=()=>{const l=async()=>{try{const{svg:g}=await N(le.url());A.value=g}catch{q.value.push("Failed to fetch QR code"),A.value=null}},n=async()=>{try{const{secretKey:g}=await N(ne.url());S.value=g}catch{q.value.push("Failed to fetch a setup key"),S.value=null}},i=()=>{S.value=null,A.value=null,d()},d=()=>{q.value=[]};return{qrCodeSvg:A,manualSetupKey:S,recoveryCodesList:D,errors:q,hasSetupData:st,clearSetupData:i,clearErrors:d,clearTwoFactorAuthData:()=>{i(),d(),D.value=[]},fetchQrCode:l,fetchSetupKey:n,fetchSetupData:async()=>{try{d(),await Promise.all([l(),n()])}catch{A.value=null,S.value=null}},fetchRecoveryCodes:async()=>{try{d(),D.value=await N(re.url())}catch{q.value.push("Failed to fetch recovery codes"),D.value=[]}}}},ot={class:"flex flex-col gap-3 select-none sm:flex-row sm:items-center sm:justify-between"},rt={key:0,class:"mt-6"},nt={key:1,class:"mt-3 space-y-3"},lt={key:0,class:"space-y-2"},it=x({__name:"TwoFactorRecoveryCodes",setup(l){const{recoveryCodesList:n,fetchRecoveryCodes:i,errors:d}=H(),m=w(!1),_=Z("recoveryCodeSectionRef"),y=async()=>{!m.value&&!n.value.length&&await i(),m.value=!m.value,m.value&&(await ee(),_.value?.scrollIntoView({behavior:"smooth"}))};return ye(async()=>{n.value.length||await i()}),(g,r)=>(s(),v(e(Fe),{class:"w-full"},{default:a(()=>[t(e(Ee),null,{default:a(()=>[t(e(Te),{class:"flex gap-3"},{default:a(()=>[t(e(Ge),{class:"size-4"}),r[0]||(r[0]=f("2FA Recovery Codes ",-1))]),_:1}),t(e(We),null,{default:a(()=>[...r[1]||(r[1]=[f(" Recovery codes let you regain access if you lose your 2FA device. Store them in a secure password manager. ",-1)])]),_:1})]),_:1}),t(e(Re),null,{default:a(()=>[o("div",ot,[t(e(k),{onClick:y,class:"w-fit"},{default:a(()=>[(s(),v(he(m.value?e(qe):e(je)),{class:"size-4"})),f(" "+$(m.value?"Hide":"View")+" Recovery Codes ",1)]),_:1}),m.value&&e(n).length?(s(),v(e(z),K({key:0},e(ie).form(),{method:"post",options:{preserveScroll:!0},onSuccess:e(i)}),{default:a(({processing:p})=>[t(e(k),{variant:"secondary",type:"submit",disabled:p},{default:a(()=>[t(e(Be)),r[2]||(r[2]=f(" Regenerate Codes ",-1))]),_:1},8,["disabled"])]),_:1},16,["onSuccess"])):_e("",!0)]),o("div",{class:M(["relative overflow-hidden transition-all duration-300",m.value?"h-auto opacity-100":"h-0 opacity-0"])},[e(d)?.length?(s(),u("div",rt,[t(te,{errors:e(d)},null,8,["errors"])])):(s(),u("div",nt,[o("div",{ref_key:"recoveryCodeSectionRef",ref:_,class:"grid gap-1 rounded-lg bg-muted p-4 font-mono text-sm"},[e(n).length?(s(!0),u(b,{key:1},F(e(n),(p,C)=>(s(),u("div",{key:C},$(p),1))),128)):(s(),u("div",lt,[(s(),u(b,null,F(8,p=>o("div",{key:p,class:"h-4 animate-pulse rounded bg-muted-foreground/20"})),64))]))],512),r[3]||(r[3]=o("p",{class:"text-xs text-muted-foreground select-none"},[f(" Each recovery code can be used once to access your account and will be removed after use. If you need more, click "),o("span",{class:"font-bold"},"Regenerate Codes"),f(" above. ")],-1))]))],2)]),_:1})]),_:1}))}}),ut={class:"mb-3 w-auto rounded-full border border-border bg-card p-0.5 shadow-sm"},ct={class:"relative overflow-hidden rounded-full border border-border bg-muted p-2.5"},dt={class:"absolute inset-0 grid grid-cols-5 opacity-50"},ft={class:"absolute inset-0 grid grid-rows-5 opacity-50"},pt={class:"relative flex w-auto flex-col items-center justify-center space-y-5"},mt={class:"relative mx-auto flex max-w-md items-center overflow-hidden"},vt={class:"relative mx-auto aspect-square w-64 overflow-hidden rounded-lg border border-border"},yt={key:0,class:"absolute inset-0 z-10 flex aspect-square h-auto w-full animate-pulse items-center justify-center bg-background"},_t={key:1,class:"relative z-10 overflow-hidden border p-5"},ht=["innerHTML"],bt={class:"flex w-full items-center space-x-5"},gt={class:"flex w-full items-center justify-center space-x-2"},kt={class:"flex w-full items-stretch overflow-hidden rounded-xl border border-border"},wt={key:0,class:"flex h-full w-full items-center justify-center bg-muted p-3"},xt=["value"],Ct=["value"],$t={class:"flex w-full flex-col items-center justify-center space-y-3 py-2"},St={class:"flex w-full items-center space-x-5"},At=x({__name:"TwoFactorSetupModal",props:be({requiresConfirmation:{type:Boolean},twoFactorEnabled:{type:Boolean}},{isOpen:{type:Boolean},isOpenModifiers:{}}),emits:["update:isOpen"],setup(l){const n=l,i=ge(l,"isOpen"),{copy:d,copied:m}=He(),{qrCodeSvg:_,manualSetupKey:y,clearSetupData:g,fetchSetupData:r,errors:p}=H(),C=w(!1),R=w([]),Q=j(()=>R.value.join("")),U=Z("pinInputContainerRef"),B=j(()=>n.twoFactorEnabled?{title:"Two-Factor Authentication Enabled",description:"Two-factor authentication is now enabled. Scan the QR code or enter the setup key in your authenticator app.",buttonText:"Close"}:C.value?{title:"Verify Authentication Code",description:"Enter the 6-digit code from your authenticator app",buttonText:"Continue"}:{title:"Enable Two-Factor Authentication",description:"To finish enabling two-factor authentication, scan the QR code or enter the setup key in your authenticator app",buttonText:"Continue"}),ae=()=>{if(n.requiresConfirmation){C.value=!0,ee(()=>{U.value?.querySelector("input")?.focus()});return}g(),i.value=!1},se=()=>{n.twoFactorEnabled&&g(),C.value=!1,R.value=[]};return ke(()=>i.value,async G=>{if(!G){se();return}_.value||await r()}),(G,c)=>(s(),v(e(Me),{open:i.value,"onUpdate:open":c[5]||(c[5]=h=>i.value=h)},{default:a(()=>[t(e(Le),{class:"sm:max-w-md"},{default:a(()=>[t(e(Ve),{class:"flex items-center justify-center"},{default:a(()=>[o("div",ut,[o("div",ct,[o("div",dt,[(s(),u(b,null,F(5,h=>o("div",{key:`col-${h}`,class:"border-r border-border last:border-r-0"})),64))]),o("div",ft,[(s(),u(b,null,F(5,h=>o("div",{key:`row-${h}`,class:"border-b border-border last:border-b-0"})),64))]),t(e(Je),{class:"relative z-20 size-6 text-foreground"})])]),t(e(De),null,{default:a(()=>[f($(B.value.title),1)]),_:1}),t(e(ze),{class:"text-center"},{default:a(()=>[f($(B.value.description),1)]),_:1})]),_:1}),o("div",pt,[C.value?(s(),v(e(z),K({key:1},e(ue).form(),{"reset-on-error":"",onFinish:c[3]||(c[3]=h=>R.value=[]),onSuccess:c[4]||(c[4]=h=>i.value=!1)}),{default:a(({errors:h,processing:I})=>[o("input",{type:"hidden",name:"code",value:Q.value},null,8,Ct),o("div",{ref_key:"pinInputContainerRef",ref:U,class:"relative w-full space-y-3"},[o("div",$t,[t(e(Ne),{id:"otp",placeholder:"â—‹",modelValue:R.value,"onUpdate:modelValue":c[1]||(c[1]=V=>R.value=V),type:"number",otp:""},{default:a(()=>[t(e(Oe),null,{default:a(()=>[(s(),u(b,null,F(6,(V,oe)=>t(e(Ke),{autofocus:"",key:V,index:oe,disabled:I},null,8,["index","disabled"])),64))]),_:2},1024)]),_:2},1032,["modelValue"]),t(Ie,{message:h?.confirmTwoFactorAuthentication?.code},null,8,["message"])]),o("div",St,[t(e(k),{type:"button",variant:"outline",class:"w-auto flex-1",onClick:c[2]||(c[2]=V=>C.value=!1),disabled:I},{default:a(()=>[...c[7]||(c[7]=[f(" Back ",-1)])]),_:1},8,["disabled"]),t(e(k),{type:"submit",class:"w-auto flex-1",disabled:I||Q.value.length<6},{default:a(()=>[...c[8]||(c[8]=[f(" Confirm ",-1)])]),_:1},8,["disabled"])])],512)]),_:1},16)):(s(),u(b,{key:0},[e(p)?.length?(s(),v(te,{key:0,errors:e(p)},null,8,["errors"])):(s(),u(b,{key:1},[o("div",mt,[o("div",vt,[e(_)?(s(),u("div",_t,[o("div",{innerHTML:e(_),class:"flex aspect-square size-full items-center justify-center"},null,8,ht)])):(s(),u("div",yt,[t(e(X),{class:"size-6"})]))])]),o("div",bt,[t(e(k),{class:"w-full",onClick:ae},{default:a(()=>[f($(B.value.buttonText),1)]),_:1})]),c[6]||(c[6]=o("div",{class:"relative flex w-full items-center justify-center"},[o("div",{class:"absolute inset-0 top-1/2 h-px w-full bg-border"}),o("span",{class:"relative bg-card px-2 py-1"},"or, enter the code manually")],-1)),o("div",gt,[o("div",kt,[e(y)?(s(),u(b,{key:1},[o("input",{type:"text",readonly:"",value:e(y),class:"h-full w-full bg-background p-3 text-foreground"},null,8,xt),o("button",{onClick:c[0]||(c[0]=h=>e(d)(e(y)||"")),class:"relative block h-auto border-l border-border px-3 hover:bg-muted"},[e(m)?(s(),v(e(Qe),{key:0,class:"w-4 text-green-500"})):(s(),v(e(Ue),{key:1,class:"w-4"}))])],64)):(s(),u("div",wt,[t(e(X))]))])])],64))],64))])]),_:1})]),_:1},8,["open"]))}}),Ft={class:"space-y-6"},Rt={class:"relative inline"},_a=x({__name:"TwoFactor",props:{requiresConfirmation:{type:Boolean,default:!1},twoFactorEnabled:{type:Boolean,default:!1}},setup(l){const n=we(),i=j(()=>n.props.store??{name:"Simple Store",tagline:"Premium Quality Products",logo:null}),d=[{title:"Autentikasi 2 Faktor",href:ce.url()}],{hasSetupData:m,clearTwoFactorAuthData:_}=H(),y=w(!1);return xe(()=>{_()}),(g,r)=>(s(),v(Pe,{breadcrumbs:d},{default:a(()=>[t(e(Ce),{title:`Autentikasi 2 Faktor - ${i.value.name}`},null,8,["title"]),t(de,null,{default:a(()=>[o("div",Ft,[t(e(T),{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:e(E).ios},{default:a(()=>[t(fe,{title:"Autentikasi 2 Faktor",description:"Kelola pengaturan autentikasi dua faktor Anda"})]),_:1},8,["transition"]),l.twoFactorEnabled?(s(),v(e(T),{key:1,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{...e(E).ios,delay:e(J)(1)},class:"flex flex-col items-start justify-start space-y-4"},{default:a(()=>[t(e(T),{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:e(E).bouncy},{default:a(()=>[t(e(W),{variant:"default"},{default:a(()=>[...r[7]||(r[7]=[f("Aktif",-1)])]),_:1})]),_:1},8,["transition"]),r[9]||(r[9]=o("p",{class:"text-muted-foreground"}," Dengan autentikasi dua faktor aktif, Anda akan diminta PIN keamanan saat login, yang dapat Anda ambil dari aplikasi TOTP di ponsel Anda. ",-1)),t(it),o("div",Rt,[t(e(z),$e(Se(e(me).form())),{default:a(({processing:p})=>[t(e(k),{variant:"destructive",type:"submit",disabled:p},{default:a(()=>[t(e(Xe)),r[8]||(r[8]=f(" Nonaktifkan 2FA ",-1))]),_:1},8,["disabled"])]),_:1},16)])]),_:1},8,["transition"])):(s(),v(e(T),{key:0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{...e(E).ios,delay:e(J)(1)},class:"flex flex-col items-start justify-start space-y-4"},{default:a(()=>[t(e(T),{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:e(E).bouncy},{default:a(()=>[t(e(W),{variant:"destructive"},{default:a(()=>[...r[3]||(r[3]=[f("Nonaktif",-1)])]),_:1})]),_:1},8,["transition"]),r[6]||(r[6]=o("p",{class:"text-muted-foreground"}," Ketika Anda mengaktifkan autentikasi dua faktor, Anda akan diminta PIN keamanan saat login. PIN ini dapat diperoleh dari aplikasi TOTP di ponsel Anda (seperti Google Authenticator). ",-1)),o("div",null,[e(m)?(s(),v(e(k),{key:0,onClick:r[0]||(r[0]=p=>y.value=!0)},{default:a(()=>[t(e(Y)),r[4]||(r[4]=f("Lanjutkan Setup ",-1))]),_:1})):(s(),v(e(z),K({key:1},e(pe).form(),{onSuccess:r[1]||(r[1]=p=>y.value=!0)}),{default:a(({processing:p})=>[t(e(k),{type:"submit",disabled:p},{default:a(()=>[t(e(Y)),r[5]||(r[5]=f("Aktifkan 2FA",-1))]),_:1},8,["disabled"])]),_:1},16))])]),_:1},8,["transition"])),t(At,{isOpen:y.value,"onUpdate:isOpen":r[2]||(r[2]=p=>y.value=p),requiresConfirmation:l.requiresConfirmation,twoFactorEnabled:l.twoFactorEnabled},null,8,["isOpen","requiresConfirmation","twoFactorEnabled"])])]),_:1})]),_:1}))}});export{_a as default};
